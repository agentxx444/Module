<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Auto Reply Ticket System</title>
    <script src="https://cdn.tailwindcss.com"></script>
  <script>
    if (window.innerWidth < 1024) {
        document.querySelector('meta[name="viewport"]').setAttribute('content', 'width=1024');
    }
</script>
    <style>
        /* Custom Colors */
        :root {
            --primary-color: #667EAC;
            --secondary-color: #7A94CB;
        }

        /* Table Styles */
        .table-container {
            width: 100%;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 12px;
            border: 1px solid #ccc;
            text-align: center;
        }

        th {
            background-color: var(--primary-color);
            color: white;
            font-weight: bold;
        }

        tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        tr:hover {
            background-color: var(--secondary-color);
            color: white;
        }

        /* Custom button styles */
        .btn {
            background-color: var(--primary-color);
            color: white;
            padding: 10px;
            font-size: 16px;
            border-radius: 5px;
            transition: background 0.3s;
        }

        .btn:hover {
            background-color: var(--secondary-color);
        }
    </style>
</head>
  
  <!-- FontAwesome Kütüphanesi -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
<body class="bg-gray-100 flex justify-center items-center min-h-screen p-6">
    <div class="container mx-auto flex flex-col lg:flex-row gap-8 w-full">
      
    <!-- Left Panel (Expanded Form) -->
    <div class="bg-white p-6 rounded-lg shadow-lg w-full lg:w-3/5">
        <h1 class="text-xl font-bold text-center text-gray-700 mb-4">Support Ticket</h1>
        <!-- Support Type -->
      <div class="relative overflow-hidden rounded-xl p-6 mb-6" style="background: linear-gradient(135deg, #f0f4ff, #d9e4ff);">
  <!-- Decorative circles inside -->
  <div class="absolute -top-10 -left-10 w-40 h-40 bg-blue-200 opacity-30 rounded-full filter blur-2xl"></div>
  <div class="absolute -bottom-10 -right-10 w-40 h-40 bg-purple-200 opacity-30 rounded-full filter blur-2xl"></div>
      
      <p style="font-size: 15px; color: #333; margin: 0; line-height: 1.5; text-align: center;">
                        <i class="fa-solid fa-robot"></i> <strong>AI Support (Robot)</strong> is designed to resolve your requests fast.
                    </p>
      <p style="font-size: 15px; color: #555; margin: 0; line-height: 1.5; text-align: center;">
                        <i class="fa-solid fa-clock"></i> <strong style="color: #333;">24/7 Active:</strong> The bot is available 24/7 and can handle your support requests instantly.
      <p style="font-size: 15px; color: #333; margin-bottom: 20px; text-align: center;">
                <i class="fa-solid fa-bolt"></i> To get instant support, please send us a message from the 
                <span style="color: #4b70ff;">"AI Support (Robot)"</span> section.
            </p>
        <p style="font-size: 15px; color: #555; margin: 0; line-height: 1.5; text-align: center;"><i class="fa-solid fa-check"></i> <strong style="color: #333;">Use properly:</strong> Please include commas every order id, ex. <b>1234,5678,2314</b>.
          
        <div style="background: rgba(0,0,0,0.02); border: 1px solid rgba(0,0,0,0.05); border-radius: 4px; padding: 15px 20px;">
                        <table style="width: 100%; font-size: 14px;">
                            <tbody><tr>
                                <td style="padding: 8px 0; color: #333; font-weight: 500;">order_id/s cancel</td>
                                <td style="padding: 8px 0; color: #666;">Cancel your order</td>
                            </tr>
                            <tr>
                                <td style="padding: 8px 0; color: #333; font-weight: 500;">order_id/s speed</td>
                                <td style="padding: 8px 0; color: #666;">Speed up order processing</td>
                            </tr>
                            <tr>
                                <td style="padding: 8px 0; color: #333; font-weight: 500;">order_id/s refill</td>
                                <td style="padding: 8px 0; color: #666;">Request a refill</td>
                            </tr>
                            <tr>
                                <td style="padding: 8px 0; color: #333; font-weight: 500;">order_id/s fake comp</td>
                                <td style="padding: 8px 0; color: #666;">Report fake completion</td>
                            </tr>
                        </tbody></table>
                    </div>
        <br>
        <div style="background: rgba(220,53,69,0.05); border-left: 3px solid #dc3545; padding: 12px 15px; margin-bottom: 25px;">
            <p style="font-size: 14px; color: #dc3545; margin: 0; text-align: center;">
                ❌ Your request was not understood. Please ensure correct use.
            </p>
        </div>
        
      <div style="display: flex; justify-content: center; gap: 15px;">
      <p href="" target="_blank" style="
                    background-color: #4B70FF;
                    color: white;
                    padding: 12px 25px;
                    text-decoration: none;
                    font-size: 14px;
                    border-radius: 3px;
                    display: inline-flex;
                    align-items: center;
                    gap: 8px;
                    min-width: 200px;
                    text-align: center;
                    justify-content: center;
                ">
                    <i class="fa-solid fa-robot"></i> AI Support (Robot)
                </p>
      </div>
      </div>
      <br>
      <br>
        <label class="block mb-2 font-semibold text-gray-700">Support Type:</label>
        <select id="supportType" class="w-full p-3 border rounded mb-4" onchange="toggleMessageField1()">
            <option value="AI Fast Support">AI Support (Robot)</option>
            <option value="Human Support">Human Support</option>
        </select>
      
		<div id="aiSupportForm">
          
        <label class="block mb-2 font-semibold text-gray-700">Action Type:</label>
        <select id="actionType" class="w-full p-3 border rounded mb-4">
            <option value="Speed">Speed</option>
            <option value="Refill">Refill</option>
            <option value="Cancel">Cancel</option>
            <option value="Fake Comp">Fake Comp</option>
        </select>

        <label class="block mb-2 font-semibold text-gray-700">Order ID(s):</label>
        <input type="text" id="orderId" placeholder="123,1245,5125" class="w-full p-3 border rounded mb-4">
		<!-- Message Field (Hidden by Default) -->
        <div id="messageContainer" style="display: none;">
            <label class="block mb-2 font-semibold text-gray-700">Message:</label>
            <textarea id="message" placeholder="Enter your message here..." class="w-full p-3 border rounded mb-4"></textarea>
        </div>
      	
   

      
        <!-- Submit Button -->
<button id="submitBtn" onclick="submitRequest()" class="w-full btn text-lg font-semibold">Submit</button>
<p id="responseMessage" class="text-center text-sm mt-4 text-gray-700"></p>
          
    </div>
</div>
    

      
    <!-- Right Panel (Expanded Ticket History Table) -->
    <div class="bg-white p-6 rounded-lg shadow-lg w-full lg:w-2/5">
        <h2 class="text-xl font-bold text-center text-gray-700 mb-4">Ticket History</h2>
        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Subject</th>
                        <th>Status</th>
                        <th>Last Update</th>
                    </tr>
                </thead>
                <tbody id="ticketTable"></tbody>
            </table>
        </div>
      <!-- Pagination Controls -->
	<div id="pagination" class="flex justify-center mt-4 space-x-2"></div>
    </div>
</div>
  
  <br>

<div id="humanSupportForm" style="display: none;">
            <!-- Main variables *content* -->
<span class="hidden">0</span>


<div class="container-fluid">
  <div class="row">
    <div class="col-md-7 ticket_order-form">
      <div class="well">
        <div class="ticket-btn-row">
          <div class="ticket-btn_container">
            <a href="#" class="media brand-category brand-category-blue" data-id="instagram" data-value="Order">
              <div class="icon"><i class="far fa-file-alt"></i></div>
              <span class="cat-name">Order</span>
            </a>
          </div>
          <div class="ticket-btn_container">
            <a href="#" class="media brand-category brand-category-blue ps_init" data-id="instagram" data-value="Payment">
              <div class="icon"><i class="fas fa-hand-holding-usd"></i></div>
              <span class="cat-name">Payment</span>
            </a>
          </div>
          <div class="ticket-btn_container">
            <a href="#" class="media brand-category brand-category-blue" data-id="instagram" data-value="API">
              <div class="icon"><i class="fal fa-cog"></i></div>
              <span class="cat-name">API</span>
            </a>
          </div>
          <div class="ticket-btn_container">
            <a href="#" class="media brand-category brand-category-blue" data-id="instagram" data-value="Child Panel">
              <div class="icon"><i class="fal fa-border-all"></i></div>
              <span class="cat-name">Child Panel</span>
            </a>
          </div>
          <div class="ticket-btn_container">
            <a href="#" class="media brand-category brand-category-blue" data-id="instagram" data-value="Bug">
              <div class="icon"><i class="fal fa-exclamation-triangle"></i></div>
              <span class="cat-name">Bug</span>
            </a>
          </div>
                    <div class="ticket-btn_container">
            <a href="#" class="media brand-category brand-category-blue" data-id="instagram" data-value="Request">
              <div class="icon"><i class="far fa-file-alt"></i></div>
              <span class="cat-name">Request</span>
            </a>
          </div>
          <div class="ticket-btn_container">
            <a href="#" class="media brand-category brand-category-blue" data-id="instagram" data-value="Other">
              <div class="icon"><i class="fal fa-ellipsis-h-alt"></i></div>
              <span class="cat-name">Other</span>
            </a>
          </div>
        </div>
        <form {% if site['rtl'] %}class="rtl-form"{% endif %} method="post" action="" id="ticketsend"> 
            <div class="alert alert-dismissible alert-danger ticket-danger {% if site['rtl'] %} rtl-alert {% endif %}" style="display: none">
                <button type="button" class="close">&times;</button>
                <div></div>
          </div>
                    <div class="siginInRow form-group">
            <label class="control-label">Subject</label>
            <select class="form-control" id="subject" name="TicketForm[subject]" onchange="handleOrderType(this)">
              <option value="" selected>Choose Subject</option> 
              <option value="New-Order" >Order</option>
              <option value="New-Payment">Payment</option>
              <option value="New-Child-Panel">Child Panel</option>
              <option value="New-API">API</option>
              <option value="New-Bug">Bug</option>
              <option value="New-Request">Request</option>
                            <option value="New-Other">Other</option>
            </select>
          </div>
          <span class="ticket-frm-body">
            <div class="siginInRow form-group" id="order-group" style="display:none;">
              <div class="extraoption_order">
                <label>
                  <input class="extraoption_order-input" type="radio" name="order_ticket" value="Restart" />
                  <span>Restart</span>
                </label>
                <label>
                  <input class="extraoption_order-input" type="radio" name="order_ticket" value="Speed-up" />
                  <span>Speed up</span>
                </label>
                <label>
                  <input class="extraoption_order-input" type="radio" name="order_ticket" value="Refill" />
                  <span>Refill</span>
                </label>
                <label>
                  <input class="extraoption_order-input" type="radio" name="order_ticket" value="Cancel" />
                  <span>Cancellation </span>
                </label>
                <label>
                  <input class="extraoption_order-input" type="radio" name="order_ticket" value="Other" />
                  <span>Other</span>
                </label>
              </div>
              <label class="control-label">Order ID: [For multiple orders, please separate them using comma. (example: 10867110,10867210,10867500)] </label>
              <input type="text" class="form-control" id="orderid" placeholder="example: 10879844">

              <label class="control-label extraoption-label" style="margin-top: 15px;">Request</label>      
              <select class="form-control extraoption" style="margin-top: 15px;" id="want">
                <option value="Refill" selected="">Refill</option>
                <option value="Cancel">Cancel</option>
                <option value="Speed-up">Speed Up</option>
                <option value="Restart">Restart</option>
                <option value="Other">Other</option>
              </select>

              <span class="reason-box" style="display:none;">
                <label class="control-label" style="margin-top: 15px;">Reason*</label>
                <textarea type="text" class="form-control" id="reason" placeholder="Enter Cancel Reason"></textarea>
              </span>
            </div>
            <div id="payment-group" style="display:none;">
                            <div class="siginInRow form-group">
                <label class="control-label">Payment</label>
                <select class="form-control extraoption" style="margin-top: 15px;" id="payment">
                  <option value="Gcash" selected="">Gcash</option>
                  <option value="Maya">Maya</option>
                  <option value="Crypto">Crypto</option>
                 <!-----<option value="Coin-payment">Coin Payment</option>
                  <option value="Bkash">Bkash</option>
                  <option value="Other">Other</option>
                  <option value="Bitcoin">Bitcoin</option>
                  <option value="Paytm">Paytm</option>
                  <option value="Perfect-money">Perfect Money</option>
                  <option value="Payeer">Payeer</option>  ---->
                </select>
              </div>
              <div class="siginInRow form-group">
                <label class="control-label">Payment ID</label>
                <input type="text" class="form-control" id="paymentid" placeholder="Ex: 003822340">
              </div>
              <div class="siginInRow form-group"> 
                <label class="control-label">Payment Email</label>
                <input type="email" class="form-control" id="paymentemail">
              </div>
              <div class="siginInRow form-group">
                <label class="control-label">Payment Amount</label>
                <input type="text" class="form-control" id="paymentamount">
              </div> 
            </div>
            <div id="api-group" style="display:none;">
              <div class="siginInRow form-group">
                <label class="control-label">Website Url</label>
                <input type="text" class="form-control" id="apiurl">
              </div>
              <div class="siginInRow form-group">
                <label class="control-label">Whatsapp/Skype/Calling Details</label>
                <input type="text" class="form-control" id="calldetail">
              </div>
              <div class="siginInRow form-group"> 
                <label class="control-label">Monthly sell</label>
                <input type="text" class="form-control" id="monthlysell">
              </div>
              <div class="siginInRow form-group">
                <label class="control-label">On which service Id do you need discount' [(example 123,453,999,998,1023,564)]</label>
                <input type="text" class="form-control" id="apidiscount">
              </div> 
            </div>
            <div id="bug-group" style="display:none;">
              <div class="siginInRow form-group">
                <label class="control-label">Bug In Website</label>
                <input type="text" class="form-control" id="websitebug">
              </div>
              <div class="siginInRow form-group">
                <label class="control-label">Bug In Services</label>
                <input type="text" class="form-control" id="servicebug">
              </div>
            </div>
            <div id="request-group" style="display:none;">
              <div class="siginInRow form-group">
                <label class="control-label">ADD THIS SERVICE</label>
                <input type="text" class="form-control" id="addservice">
              </div>
              <div class="siginInRow form-group">
                <label class="control-label">ADD THIS FEATURE</label>
                <input type="text" class="form-control" id="addfeature">
              </div>
              <div class="siginInRow form-group">
                <label class="control-label">ADD THIS PAYMENT METHOD</label>
                <input type="text" class="form-control" id="addpaymentmethod">
              </div>
            </div>
            <div class="siginInRow form-group" id="point-group" style="display:none;">
              <div class="extraoption_order">
                <label>
                  <input class="extraoption_order-input2" type="radio" name="redeem_ticket" value="Redeem-Point" />
                  <span>Redeem My Point</span>
                </label>
                <label>
                  <input class="extraoption_order-input2" type="radio" name="redeem_ticket" value="Question-about-point" />
                  <span>Ask a Question about points</span>
                </label>
              </div>
              <label class="control-label extraoption-label" style="margin-top: 15px;">Request</label>
              <select class="form-control extraoption" style="margin-top: 15px;" id="want1">
                <option value="Redeem-Point" selected="">Redeem My Point</option>
                <option value="Question-about-point">Ask a Question About Point</option>
              </select>
            </div>
                        <div class="siginInRow form-group ticket-textarea">
              <label class="control-label">Message<span id="optional"> (optional) </span></label>    
              <textarea class="form-control" rows="4" cols="50" id="humanMessage" placeholder="Your Message Here"></textarea>
            </div>  
            
            <div class="form-group">
                  <div
                    class="tickets-uploader"
                    data-rtl="{% if site['rtl'] %}true{% else %}false{% endif %}"
                    data-lang-button-attach="{{ lang('tickets.button.attach') }}"
                    data-lang-file-format-incorrect="{{ lang('tickets.error.file_format.incorrect') }}"
                    data-lang-file-size-incorrect="{{ lang('tickets.error.file_size.incorrect') }}"
                  ></div>
                </div>
            
            <input type="hidden" name="_csrf" value="{{csrftoken}}">
            <input type="hidden" id="hmessage" name="TicketForm[message]">
            <button type="submit" class="btn btn-primary btn-block">{{ lang('tickets.button') }}</button>
          </span>
        </form>
      </div>

            
          </div>
    
    
    
    
  <script>// Toggle Message Input for Human Support
function toggleMessageField() {
    const supportType = document.getElementById("supportType").value;
    const messageContainer = document.getElementById("messageContainer");
    const actionTypeContainer = document.getElementById("actionTypeContainer");

    if (supportType === "Human Support") {
        messageContainer.style.display = "block"; // Show message field
        actionTypeContainer.style.display = "none"; // Hide action type dropdown
    } else {
        messageContainer.style.display = "none"; // Hide message field
        actionTypeContainer.style.display = "block"; // Show action type dropdown
    }
}
    
    function toggleMessageField1() {
    const supportType = document.getElementById("supportType").value;
    const aiSupportForm = document.getElementById("aiSupportForm");
    const humanSupportForm = document.getElementById("humanSupportForm");

    if (supportType === "Human Support") {
        aiSupportForm.style.display = "none";
        humanSupportForm.style.display = "block";
    } else {
        aiSupportForm.style.display = "block";
        humanSupportForm.style.display = "none";
    }
}

</script>

<script>
const SERVER_URL = "https://ticketsystem-rho.vercel.app/api"; // Your API

let isSubmitting = false; // Prevent multiple submissions

async function submitRequest() {
    if (isSubmitting) return; // Prevent double submission
    isSubmitting = true;

    const supportType = document.getElementById("supportType").value;
    const orderId = document.getElementById("orderId").value.trim();
    const messageField = document.getElementById("message");
    const message = messageField ? messageField.value.trim() : "";

    const actionTypeElement = document.getElementById("actionType");
    const actionType = (supportType === "AI Fast Support" && actionTypeElement) ? actionTypeElement.value : null;

    const username = window.loggedInUser?.username || "UnknownUser"; 

    if (!orderId) {
        document.getElementById("responseMessage").innerText = "❌ Please enter Order ID(s).";
        isSubmitting = false;
        return;
    }

    const payload = {
        supportType,
        orderId,
        username,
        subject: supportType === "AI Fast Support" && actionType 
                    ? `AI Fast Support - ${actionType}` 
                    : "Human Support Request"
    };

    if (supportType === "Human Support" && message) {
        payload.message = message;
        payload.staff_name = username;
    }

    if (actionType) {
        payload.actionType = actionType;
    }

    try {
        const response = await fetch(`${SERVER_URL}/ticket`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            mode: "cors",
            body: JSON.stringify(payload),
        });

        const result = await response.json();

        if (!response.ok) {
            throw new Error(result.error || "An unknown error occurred.");
        }

        document.getElementById("responseMessage").innerText = "✅ Ticket submitted successfully!";
        if (messageField) messageField.value = "";
        fetchTickets(); // Refresh ticket list

    } catch (error) {
        console.error("Error submitting ticket:", error);
        document.getElementById("responseMessage").innerText = `❌ ${error.message}`;
    }

    isSubmitting = false;
}





// Function to fetch tickets
let currentPage = 1;
const ticketsPerPage = 8;

async function fetchTickets(page = 1) {
    if (!window.loggedInUser || !window.loggedInUser.isAuthenticated) {
        console.log("User not authenticated.");
        return;
    }

    const username = window.loggedInUser?.username;
    if (!username) {
        document.getElementById("responseMessage").innerText = "Login required.";
        return;
    }

    try {
        
        const response = await fetch(`${SERVER_URL}/tickets?user=${encodeURIComponent(username)}`, {
            method: "GET",
            credentials: "include",
            headers: { "Content-Type": "application/json" }
        });

        const data = await response.json();
        if (data.error) {
            console.error("API Error:", data.error);
            return;
        }

        const ticketTable = document.getElementById("ticketTable");
        if (!ticketTable) return;

        ticketTable.innerHTML = "";

        if (data.tickets.length === 0) {
            ticketTable.innerHTML = "<tr><td colspan='4' class='text-center p-2'>No tickets found</td></tr>";
            return;
        }

        const start = (page - 1) * ticketsPerPage;
        const end = start + ticketsPerPage;
        const paginatedTickets = data.tickets.slice(start, end);

        paginatedTickets.forEach(ticket => {
            const statusBadge = getStatusBadge(ticket.status);
            const isBold = ticket.status === "ANSWERED" ? "font-bold" : "";

            const row = document.createElement("tr");
            row.className = "cursor-pointer hover:bg-gray-50 transition";
            row.innerHTML = `
                <td class="border border-gray-300 p-2">${ticket.id}</td>
                <td class="border border-gray-300 p-2 subject ${isBold}" data-ticket-id="${ticket.id}">${ticket.subject}</td>
                <td class="border border-gray-300 p-2">${statusBadge}</td>
                <td class="border border-gray-300 p-2">${ticket.last_update}</td>
            `;

            row.onclick = () => {
                viewTicket(ticket.id);
                removeBold(ticket.id);
            };

            ticketTable.appendChild(row);
        });

        createPaginationButtons(data.tickets.length, page);
    } catch (error) {
        console.error("Error fetching tickets:", error);
    }
}

// Function to remove bold text once clicked
function removeBold(ticketId) {
    const subjectElement = document.querySelector(`.subject[data-ticket-id="${ticketId}"]`);
    if (subjectElement) {
        subjectElement.classList.remove("font-bold");
    }
}


// Function to generate status badges with the requested design
function getStatusBadge(status) {
    let bgColor = "bg-gray-200 text-gray-700"; // Default style

    switch (status.toUpperCase()) {
        case "PENDING":
            bgColor = "bg-yellow-500 text-white px-3 py-1 rounded-full font-semibold shadow"; // Pending badge design
            break;
        case "ANSWERED":
            bgColor = "bg-green-500 text-white px-3 py-1 rounded-full font-semibold shadow"; // Answered badge design
            break;
        case "LOCKED":
            bgColor = "bg-red-500 text-white px-3 py-1 rounded-full font-semibold shadow"; // Locked badge design
            break;
        case "CLOSED":
            bgColor = "bg-orange-600 text-white px-3 py-1 rounded-full font-semibold shadow"; // Dark orange badge design for CLOSED
            break;
        default:
            bgColor = "bg-gray-200 text-gray-700 px-3 py-1 rounded-full font-semibold"; // Default badge design
    }

    return `<span class="${bgColor}">${status}</span>`;  // Return badge with the appropriate styles
}






// Function to create pagination buttons
function createPaginationButtons(totalTickets, activePage) {
    const totalPages = Math.ceil(totalTickets / ticketsPerPage);
    const paginationDiv = document.getElementById("pagination");
    paginationDiv.innerHTML = "";

    for (let i = 1; i <= totalPages; i++) {
        const btn = document.createElement("button");
        btn.innerText = i;
        btn.className = `px-3 py-1 rounded border ${i === activePage ? 'bg-blue-500 text-white' : 'bg-gray-200'}`;
        btn.onclick = () => {
            currentPage = i;
            fetchTickets(i);
        };
        paginationDiv.appendChild(btn);
    }
}

// Ensure tickets load after authentication check
window.addEventListener("DOMContentLoaded", () => {
    setTimeout(() => {
        fetchTickets(1);
    }, 500); // Delay slightly to ensure authentication is processed
});

// Get status color
function getStatusColor(status) {
    switch (status) {
        case "Pending": return "text-yellow-500 font-bold";  // Pending status color
        case "In Progress": return "text-blue-500 font-bold";  // In Progress status color
        case "Completed": return "text-green-500 font-bold";  // Completed status color
        case "Cancelled": return "text-red-500 font-bold";  // Cancelled status color
        case "CLOSED": return "text-white font-bold";  // CLOSED status color (dark orange with white text)
        default: return "text-gray-500";  // Default color
    }
}



// Redirect to ticket details page
function viewTicket(ticketId) {
    window.location.href = `/viewticket/${ticketId}`;
}

window.addEventListener("DOMContentLoaded", fetchTickets);
</script>

<script>
    // Force desktop view on larger screens
    function forceDesktopView() {
        if (window.innerWidth > 768) {
            document.querySelector("meta[name=viewport]").setAttribute("content", "width=1200");
        }
    }
    forceDesktopView();
    window.addEventListener("resize", forceDesktopView);
</script>

<script>
    window.loggedInUser = {
        username: "{{ user['username'] }}",
        isAuthenticated: {{ user['auth'] ? 'true' : 'false' }}
    };

</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.js" integrity="sha512-n/4gHW3atM3QqRcbCn6ewmpxcLAHGaDjpEBu4xZd47N0W2oQ+6q7oc3PXstrJYXcbNU1OHdQ1T7pAP+gi5Yu8g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>



<script>
  function handleOrderType(selectObject) {
    var element = document.getElementById("order-group");
    var element2 = document.getElementById("payment-group");
    var element3 = document.getElementById("api-group");
    var element4 = document.getElementById("bug-group");
    var element5 = document.getElementById("request-group");
    var element6 = document.getElementById("point-group");
    var optional = document.getElementById("optional");
    if (selectObject.value == "New-Order" || selectObject.value == "New-VIP-Order") {
      element.style.display = "block";
      element2.style.display = "none";
      element3.style.display = "none";
      element4.style.display = "none";
      element5.style.display = "none";
      element6.style.display = "none";
      optional.style.display = "inline";
      $("#want option:selected").prop("selected", true);
      $("#payment option:selected").prop("selected", false);
    } else if (selectObject.value == "New-Payment" || selectObject.value == "New-VIP-Payment") {
      element.style.display = "none";
      element2.style.display = "block";
      element3.style.display = "none";
      element4.style.display = "none";
      element5.style.display = "none";
      element6.style.display = "none";
      optional.style.display = "none";
      $("#want option:selected").prop("selected", false);
      $("#payment option:selected").prop("selected", true);
      // $('#paymentbox').css('display','block');
      // $('#paymentbox').style.display = "block";

    } else if (selectObject.value == "New-Child-Panel" || selectObject.value == "New-VIP-Child-Panel" ) {
      element.style.display = "none";
      element2.style.display = "none";
      element3.style.display = "none";
      element4.style.display = "none";
      element5.style.display = "none";
      element6.style.display = "none";
      optional.style.display = "none";
    } else if (selectObject.value == "New-API" || selectObject.value == "New-VIP-API" ) {
      element.style.display = "none";
      element2.style.display = "none";
      element3.style.display = "block";
      element4.style.display = "none";
      element5.style.display = "none";
      optional.style.display = "none";
      element6.style.display = "none";
    }  else if (selectObject.value == "New-Bug" || selectObject.value == "New-VIP-Bug" ) {
      element.style.display = "none";
      element2.style.display = "none";
      element3.style.display = "none";
      element4.style.display = "block";
      element5.style.display = "none";
      element6.style.display = "none";
      optional.style.display = "none";
    } else if (selectObject.value == "New-Request" || selectObject.value == "New-VIP-Request" ) {
      element.style.display = "none";
      element2.style.display = "none";
      element3.style.display = "none";
      element4.style.display = "none";
      element5.style.display = "block";
      element6.style.display = "none";
      optional.style.display = "none";
    } else if (selectObject.value == "New-Point" || selectObject.value == "New-VIP-Point" ) {
      element.style.display = "none";
      element2.style.display = "none";
      element3.style.display = "none";
      element4.style.display = "none";
      element6.style.display = "block";
      element5.style.display = "none";
      optional.style.display = "none";
      $("#want option:selected").prop("selected", false);
      $("#payment option:selected").prop("selected", false);
      $("#want1 option:selected").prop("selected", true);
    } else if (selectObject.value == "New-Other" || selectObject.value == "New-VIP-Other" ) {
      element.style.display = "none";
      element2.style.display = "none";
      element3.style.display = "none";
      element4.style.display = "none";
      element5.style.display = "none";
      element6.style.display = "none";
      optional.style.display = "none";
    }
  }

  function createTicket(e) {
    if (e.preventDefault) e.preventDefault();

    //  var paysub = $('#payment option:checked').val();
    var want = $('#want :selected').val();
    var paym = $('#payment :selected').val();
    var want1 = $('#want1 :selected').val();
    //	var want = $('#want').find(":selected").val();
    //  var sub = document.getElementById("subject").value;
    //  var subject = sub + "-" + want;
    //   alert(subject);

    var subject = document.getElementById("subject").value;
    $finalsubject = subject;
    var message = "";
    if (subject == "New-Order" || subject == "New-VIP-Order") {
      if ( want == 'Cancel' ) {
        message = "Order ID: " + document.getElementById("orderid").value + "\n" + "Request: " + document.getElementById("want").value  + "\n" + "Reason: " + document.getElementById("reason").value + "\n" + document.getElementById("humanMessage").value;
        $finalsubject += ' - ' + want;
      } else {
        message = "Order ID: " + document.getElementById("orderid").value + "\n" + "Request: " + document.getElementById("want").value  + "\n" + document.getElementById("humanMessage").value;
        $finalsubject += ' - ' + want;
      }
    } else if (subject == "New-Payment" || subject == "New-VIP-Payment") {
      message = "Payment: " + document.getElementById("payment").value  + "\n" + "Payment Id: " + document.getElementById("paymentid").value + "\n" + "Payment Email: " + document.getElementById("paymentemail").value + "\n" + "Payment Amount: " + document.getElementById("paymentamount").value + "\n" +  document.getElementById("humanMessage").value;
      $finalsubject += ' - ' + paym;
    } else if (subject == "New-API" || subject == "New-VIP-API") {
      message = "Website Url: " + document.getElementById("apiurl").value  + "\n" + "Calling Details: " + document.getElementById("calldetail").value + "\n" + "Monthly Sell: " + document.getElementById("monthlysell").value + "\n" + "Discount: " + document.getElementById("apidiscount").value + "\n" +  document.getElementById("humanMessage").value;
    } else if (subject == "New-Bug" || subject == "New-VIP-Bug") {
      message = "Bug In Website: " + document.getElementById("websitebug").value  + "\n" + "Bug In Service: " + document.getElementById("servicebug").value + "\n" + document.getElementById("humanMessage").value;
    } else if (subject == "New-Request" || subject == "New-VIP-Request") {
      message = "ADD THIS SERVICE: " + document.getElementById("addservice").value  + "\n" + "ADD THIS FEATURE: " + document.getElementById("addfeature").value + "\n" + "ADD THIS PAYMENT METHOD: " + document.getElementById("addpaymentmethod").value + "\n" + document.getElementById("humanMessage").value;
    } else if (subject == "New-Point" || subject == "New-VIP-Point") {
      message = document.getElementById("want1").value + "\n" + document.getElementById("humanMessage").value;
      $finalsubject += ' - ' + want1;
    }  else {
      message = document.getElementById("humanMessage").value;
    }

    $('#subject :selected').val($finalsubject);
    document.getElementById("hmessage").value = message;

    return true;
  }


  var form = document.getElementById("ticketsend");
  if (form.attachEvent) {
    form.attachEvent("submit", createTicket);
  } else {
    form.addEventListener("submit", createTicket);
  }



</script>




<script>
  $(document).ready(function() {
    $('.brand-category').click(function() { 
      var btn_val = $(this).data('value');
      if (btn_val == $('#subject option').val() ) {
        // console.log(btn_val); 
        // $('#subject').trigger('change');
      } else {

      }
    });
  });
</script>
<script>
  $('.brand-category').on('click', function() {
    var ticket = $(this).data('value');

    $("#subject option").filter(function() {
      //may want to use $.trim in here
      return $(this).text() == ticket;
    }).prop('selected', true);
    $('#subject').trigger('change');

    console.log(ticket);
  });
</script>
<script>
  let selectInputOptions = document.querySelectorAll('.extraoption_order-input');
  selectInputOptions.forEach((button) => {
    button.addEventListener('change', (e)=> {
      const wantSelectBtn = document.querySelector('#want');
      wantSelectBtn.value = e.target.value;
    })})
  const selectOptionWant2 = document.querySelectorAll('.extraoption_order-input2');
  selectOptionWant2.forEach((button) => {
    button.addEventListener('change', (e)=> {
      const wantSelectBtn = document.querySelector('#want1');
      wantSelectBtn.value = e.target.value;
    })})
  const triggerSliderInit = document.querySelector('.ps_init') 
  triggerSliderInit.addEventListener('click', ()=>{
    $('.left-arrow').trigger('click');
  })
  const selectPayInput = Array.from(document.querySelectorAll('.pm_select ')) 
  selectPayInput.forEach((button) => {
    button.addEventListener('click', (e)=> {
      e.preventDefault();
      const wantSelectBtn = document.querySelector('#payment');
      wantSelectBtn.value = e.target.dataset.pay;
    })})

</script>
</body>
</html>
